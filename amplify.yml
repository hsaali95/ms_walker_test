version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm install
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - "**/*"
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
      - .npm/**/*
  customHeaders:
    - pattern: "**/*"
      headers:
        - key: "Cache-Control"
          value: "no-cache, no-store, must-revalidate, max-age=0, s-maxage=0"
  environment:
    variables:
      DEFAULT_PASSWORD: ${DEFAULT_PASSWORD}
      POSTGRESQL_CONNECTION_STRING: ${POSTGRESQL_CONNECTION_STRING}
      JWT_ACCESS_TOKEN_SECRET: ${JWT_ACCESS_TOKEN_SECRET}
      JWT_REFRESH_TOKEN_SECRET: ${JWT_REFRESH_TOKEN_SECRET}
      ACCESS_TOKEN_TIME: ${ACCESS_TOKEN_TIME}
      REFRESH_TOKEN_TIME: ${REFRESH_TOKEN_TIME}
      NEXT_PUBLIC_REACT_APP_BASE_URL: ${NEXT_PUBLIC_REACT_APP_BASE_URL}
      NEXT_PUBLIC_S3_IMAGES_URL: ${NEXT_PUBLIC_S3_IMAGES_URL}
      AWS_SECRET_ACCESS_KEY: ${AWS_SECRET_ACCESS_KEY}
      AWS_ACCESS_KEY_ID: ${AWS_ACCESS_KEY_ID}
      AWS_REGION: ${AWS_REGION}
      AWS_BUCKET: ${AWS_BUCKET}
      AWS_END_POINT: ${AWS_END_POINT}
