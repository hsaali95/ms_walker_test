version: 1
frontend:
  phases:
    preBuild:
      commands:
        - npm install
    build:
      commands:
        - npm run build
  artifacts:
    baseDirectory: .next
    files:
      - "**/*"
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
      - .npm/**/*
  customHeaders:
    - pattern: "**/*"
      headers:
        - key: "Cache-Control"
          value: "no-cache, no-store, must-revalidate, max-age=0, s-maxage=0"
  environment:
    variables:
      DEFAULT_PASSWORD: ${DEFAULT_PASSWORD}
      POSTGRESQL_CONNECTION_STRING: ${POSTGRESQL_CONNECTION_STRING}
      JWT_ACCESS_TOKEN_SECRET: ${JWT_ACCESS_TOKEN_SECRET}
      JWT_REFRESH_TOKEN_SECRET: ${JWT_REFRESH_TOKEN_SECRET}
      NEXT_PUBLIC_ACCESS_TOKEN_TIME: ${NEXT_PUBLIC_ACCESS_TOKEN_TIME}
      NEXT_PUBLIC_REFRESH_TOKEN_TIME: ${NEXT_PUBLIC_REFRESH_TOKEN_TIME}
      NEXT_PUBLIC_REACT_APP_BASE_URL: ${NEXT_PUBLIC_REACT_APP_BASE_URL}
      NEXT_PUBLIC_S3_IMAGES_URL: ${NEXT_PUBLIC_S3_IMAGES_URL}
      SECRET_ACCESS_KEY: ${SECRET_ACCESS_KEY}
      ACCESS_KEY_ID: ${ACCESS_KEY_ID}
      REGION: ${REGION}
      BUCKET: ${BUCKET}
      S3_END_POINT: ${S3_END_POINT}
